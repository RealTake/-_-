<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.finotek.board.dao.IDAO">

    <update id="modifyPost_A" parameterType="com.finotek.board.dto.BoardDTO">
		UPDATE BOARDS SET TITLE = #{TITLE}, CONTENT = #{CONTENT} WHERE BID = #{BID}
	</update>

    <update id="modifyPost_U" parameterType="com.finotek.board.dto.BoardDTO">
		UPDATE BOARDS SET TITLE = #{TITLE}, CONTENT = #{CONTENT} WHERE BID = #{BID} AND WRITER = #{WRITER}
	</update>

    <select id="getPost_A" resultType="com.finotek.board.dto.BoardDTO">
		SELECT BID, TITLE, WRITER, WDATE, CONTENT FROM BOARDS WHERE BID = #{param1}
	</select>

    <select id="getPost_U" resultType="com.finotek.board.dto.BoardDTO">
		SELECT BID, TITLE, WRITER, WDATE, CONTENT FROM BOARDS WHERE BID =  #{param1} AND WRITER = #{param2}
	</select>

    <select id="getSearchPostList_A" resultType="com.finotek.board.dto.BoardDTO" parameterType="map">
		SELECT * FROM (SELECT rownum as rownumber, b.* FROM (SELECT * FROM BOARDS  WHERE (UPPER(CONTENT) LIKE UPPER('%'|| #{CONTENT} ||'%') OR UPPER(TITLE) LIKE UPPER('%'|| #{CONTENT} ||'%')) ORDER BY BID DESC) b)  WHERE rownumber >= #{start} AND rownumber &lt;= #{end}
	</select>

    <select id="getSearchPostList_U" resultType="com.finotek.board.dto.BoardDTO" parameterType="map">
		SELECT * FROM (SELECT rownum as rownumber, b.* FROM (SELECT * FROM BOARDS  WHERE WRITER = #{ID} AND (UPPER(CONTENT) LIKE UPPER('%'|| #{CONTENT} ||'%') OR UPPER(TITLE) LIKE UPPER('%'|| #{CONTENT} ||'%')) ORDER BY BID DESC) b)  WHERE rownumber >= #{start} AND rownumber &lt;= #{end}
	</select>

    <insert id="writePost" parameterType="com.finotek.board.dto.BoardDTO">
		INSERT INTO BOARDS (BID, WRITER, CONTENT, TITLE, WDATE) VALUES (BOARD_SEQ.NEXTVAL, #{WRITER}, #{CONTENT}, #{TITLE}, #{WDATE})
	</insert>

    <delete id="deletePost_A">
		DELETE FROM BOARDS WHERE BID = #{param1}
	</delete>

    <delete id="deletePost_U">
		DELETE FROM BOARDS WHERE BID = #{param1} AND WRITER = #{param2}
	</delete>

</mapper>
